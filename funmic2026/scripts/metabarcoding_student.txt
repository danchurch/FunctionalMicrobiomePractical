## Let's go through the results of last year's SIP experiment.
## Next year they will do the same with your data!

conda activate qualityControlRawSequences



cd /vol/funmic


mkdir metabarcoding



## go to the directory with the raw read files
cd /vol/funmic/datasets/Barcode2026/raw_reads





mkdir /vol/funmic/metabarcoding



cd /vol/funmic/metabarcoding


## our raw sequence data is stored here:



ls /vol/funmic/datasets/Barcode2026/raw_reads

zless Y13-07.fastq.gz




cd /vol/funmic/datasets/Barcode2026



fastqc -o . -t 2 allRawReads.fastq.gz

## we can run a quality check using the program fastqc
fastqc -o .  -t 12 /vol/funmic/datasets/Barcode2026/allRawReads.fastq.gz


## just for Dan:
scp -P 31993 ubuntu@129.70.51.6:/vol/funmic/datasets/Barcode2026/allRawReads_fastqc.html /home/daniel/Documents/teaching/functionalMicrobiomes/scratchpad/
## just for Dan ^

## we have a set of forward 16s primers (515F) that look like this:
  GTGYCAGCMGCCGCGGTAA
 CGTGYCAGCMGCCGCGGTAA
TCGTGYCAGCMGCCGCGGTAA

## our 16S 806 reverse primer is:
GGACTACNVGGGTWTCTAAT

## (https://www.bioinformatics.org/sms/iupac.html)

## we can feed this info to our primer-cutting software

## make a folder to put your trimmed reads:


inputFastq=A12-05.fastq.gz ## example file
outputDir=/vol/funmic/metabarcoding/trimmed_reads/

cutadapt --rc \
    -g TCGTGYCAGCMGCCGCGGTAA \
    --length 280 \
    -a GGACTACNVGGGTWTCTAAT \
    -o ${outputDir}${inputFastq} \
       ${inputFastq}


cd /vol/funmic/datasets/Barcode2026

mkdir /vol/funmic/metabarcoding/trimmed_reads/

## make a directory to put our trimmed files, if you didn't already above
mkdir /vol/funmic/metabarcoding/trimmed_reads/

## make sure you are still in the directory with the raw read files
cd /vol/funmic/datasets/Barcode2026/raw_reads

## and redo, this time looping through ALL of our raw reads files
outputDir=/vol/funmic/metabarcoding/trimmed_reads/
for inputFastq in *; do
    cutadapt --rc \
        -g TCGTGYCAGCMGCCGCGGTAA \
        --length 280 \
        -a GGACTACNVGGGTWTCTAAT \
        -o ${outputDir}${inputFastq} \
           ${inputFastq}
done






